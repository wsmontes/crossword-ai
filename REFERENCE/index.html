<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chess LLM</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <div class="container">
        <header class="game-header">
            <h1><i class="fas fa-chess-king"></i> Chess LLM</h1>
            <div class="game-info">
                <div class="player-info">
                    <div class="player human-player">
                        <i class="fas fa-user"></i>
                        <span>You (White)</span>
                    </div>
                    <div class="player ai-player">
                        <i class="fas fa-robot"></i>
                        <span id="ai-player-label">LLM (Black)</span>
                    </div>
                </div>
                <div class="game-status">
                    <span id="status-text">Your turn - White to move</span>
                    <div class="thinking-indicator" id="thinking-indicator">
                        <i class="fas fa-cog fa-spin"></i>
                        <span>LLM is thinking...</span>
                    </div>
                </div>
            </div>
        </header>

        <main class="game-container">
            <div class="game-board-container">
                <div class="board-wrapper">
                    <div class="coordinate-labels">
                        <div class="rank-labels">
                            <div class="rank-label">8</div>
                            <div class="rank-label">7</div>
                            <div class="rank-label">6</div>
                            <div class="rank-label">5</div>
                            <div class="rank-label">4</div>
                            <div class="rank-label">3</div>
                            <div class="rank-label">2</div>
                            <div class="rank-label">1</div>
                        </div>
                        <div class="chess-board" id="chess-board">
                            <!-- Board squares will be generated by JavaScript -->
                        </div>
                        <div class="file-labels">
                            <div class="file-label">a</div>
                            <div class="file-label">b</div>
                            <div class="file-label">c</div>
                            <div class="file-label">d</div>
                            <div class="file-label">e</div>
                            <div class="file-label">f</div>
                            <div class="file-label">g</div>
                            <div class="file-label">h</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="game-panel">
                <div class="llm-thinking">
                    <h3>
                        <span><i class="fas fa-brain"></i> LLM Thinking Process</span>
                        <label class="thinking-toggle">
                            <input type="checkbox" id="thinking-toggle" checked>
                            <span>Show thinking</span>
                        </label>
                    </h3>
                    <div class="thinking-content" id="thinking-content">
                        <div class="thinking-placeholder">
                            LLM thinking process will appear here during moves
                        </div>
                    </div>
                </div>

                <div class="move-history">
                    <h3><i class="fas fa-history"></i> Move History</h3>
                    <div class="moves-container" id="moves-container">
                        <div class="no-moves">Game hasn't started yet</div>
                    </div>
                </div>

                <div class="game-controls">
                    <button class="control-btn new-game-btn" id="new-game-btn">
                        <i class="fas fa-plus"></i> New Game
                    </button>
                    <button class="control-btn undo-btn" id="undo-btn" disabled>
                        <i class="fas fa-undo"></i> Undo Move
                    </button>
                    <button class="control-btn hint-btn" id="hint-btn">
                        <i class="fas fa-lightbulb"></i> Get Hint
                    </button>
                </div>

                <div class="llm-settings">
                    <h3><i class="fas fa-cogs"></i> LLM Settings</h3>
                    
                    <div class="setting-group">
                        <label for="llm-provider">Provider:</label>
                        <select id="llm-provider">
                            <option value="lmstudio">LM Studio (Local)</option>
                            <option value="openai">OpenAI GPT-3.5 Turbo</option>
                        </select>
                    </div>

                    <div id="lmstudio-settings">
                        <div class="setting-group">
                            <label for="llm-model">Model:</label>
                            <input type="text" id="llm-model" value="google/gemma-3-4b" placeholder="Model name">
                        </div>
                        <div class="setting-group">
                            <label for="llm-endpoint">Endpoint:</label>
                            <input type="text" id="llm-endpoint" value="http://localhost:1234" placeholder="LM Studio endpoint">
                        </div>
                    </div>

                    <div id="openai-settings" style="display: none;">
                        <div class="setting-group">
                            <label for="openai-api-key">API Key:</label>
                            <input type="password" id="openai-api-key" placeholder="sk-..." autocomplete="off">
                            <small class="setting-help">Your OpenAI API key (stored securely in browser)</small>
                            <div class="security-notice">
                                <i class="fas fa-shield-alt"></i>
                                Your API key is encrypted and stored locally in your browser. It never leaves your device except when making API calls to OpenAI.
                            </div>
                        </div>
                        <div class="setting-group">
                            <label for="openai-model">Model:</label>
                            <select id="openai-model">
                                <option value="gpt-3.5-turbo">GPT-3.5 Turbo</option>
                                <option value="gpt-3.5-turbo-1106">GPT-3.5 Turbo (Nov 2023)</option>
                                <option value="gpt-4">GPT-4</option>
                                <option value="gpt-4-turbo-preview">GPT-4 Turbo</option>
                            </select>
                        </div>
                    </div>

                    <div class="setting-group">
                        <label for="llm-temperature">Temperature:</label>
                        <input type="range" id="llm-temperature" min="0" max="1" step="0.1" value="0.3">
                        <span id="temperature-value">0.3</span>
                    </div>
                    
                    <div class="connection-status" id="connection-status">
                        <i class="fas fa-circle"></i>
                        <span>Not connected</span>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <div class="modal" id="game-over-modal">
        <div class="modal-content">
            <h2 id="game-result-title">Game Over</h2>
            <p id="game-result-message">The game has ended.</p>
            <div class="modal-actions">
                <button class="control-btn" id="new-game-modal-btn">
                    <i class="fas fa-plus"></i> New Game
                </button>
                <button class="control-btn secondary" id="close-modal-btn">
                    <i class="fas fa-times"></i> Close
                </button>
            </div>
        </div>
    </div>

    <!-- Load scripts in proper dependency order -->
    <script src="secure-storage.js"></script>
    <script src="utils/chess-utils.js"></script>
    <script src="llm-prompts.js"></script>
    <script src="chess-engine.js"></script>
    <script src="llm-client.js"></script>
    <script src="ui/board-manager.js"></script>
    <script src="ui/settings-manager.js"></script>
    <script src="ui/thinking-display.js"></script>
    <script src="ui/move-handler.js"></script>
    <script src="ui/game-controller.js"></script>
    <script src="chess-ui.js"></script>
    <script src="main.js"></script>
</body>
</html>
